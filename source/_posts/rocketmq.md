---
title: RocketMQ
date: 2021-12-02 23:26:30
tags:
    - MQ
    - RocketMQ
categories:
    - 消息队列
    - RocketMQ
---

### 一、介绍

[Apache RocketMQ](https://github.com/apache/rocketmq)

消息队列作用：
1.异步：通过将任务放入消息队列，发送方可以立即返回，而接收方可以异步地处理任务。这样可以提高系统的响应速度和吞吐量。
2.削峰：当系统面临突发流量或者高峰期时，消息队列可以缓存请求并平滑处理负载，从而保护系统免受过载。
3.解耦：通过引入消息队列，发送方和接收方之间的依赖关系变得松散，从而提高系统的可扩展性和可维护性。

### 二、概念

1.Producer 生产者
将消息存进消息队列中的一方，实际是发送给broker，由broker处理。

发送方式：
- 同步发送：发送方发送消息后，一直等待broker返回确认信息，确认消息是否成功发送到消息队列中。在此期间，发送方可能会发生阻塞。如果发送失败，则通知发送方重新发送。
- 异步发送：发送方发送消息后，不需要等待broker的确认信息，而是立即返回。发送方可以继续执行其他操作，而broker会异步地处理收到的消息。这种方式对于大量的数据或者高并发场景非常适用，可以提高系统的响应速度和吞吐量。
- 顺序发送：保证按照发送的顺序将消息发送到消息队列中，从而保证消息的处理顺序与发送顺序一致。这种发送方式通常用于需要严格控制消息处理顺序的场景，例如订单支付等。
- 单向发送：发送方只发送消息，而不需要等待broker的任何响应。这种发送方式通常用于发送一些不需要确认的消息，例如日志记录等。

同步和异步方式均需要Broker返回确认信息，单向发送不需要。

2.Consumer 消费者
从消息队列中取出消息的一方

3.Broker 代理
消息中转角色，负责存储消息、转发消息。

4.Topic 消息分类
表示一类消息的集合，每个主题包含若干条消息，每条消息只能属于一个主题，是RocketMQ进行消息订阅的基本单位。
每个Topic的消息也可以分片存储于不同的 Broker


### 三、部署
[5分钟不到！Docker搭建RocketMQ，史上最快教程！](https://cloud.tencent.com/developer/article/1621263)

### 四、使用场景

[特性](https://github.com/apache/rocketmq/blob/master/docs/cn/features.md)
- 1. 订阅发布：消息队列中的发布者将消息发送到一个主题(topic)中，同时订阅者可以从该主题中订阅并接收相关消息。
- 2. 消息顺序：确保同一个消息在队列中按照发送的顺序被消费，这种特性通常应用于需要精细控制业务逻辑的场景，如订单系统等。
- 3. 消息过滤：只将满足某些条件的消息传递给订阅者。这种特性能够提高消息的处理效率和可靠性。
- 4. 消息可靠性：确保消息不会丢失、重复或乱序，确保消息在分布式环境下的正确性和完整性。
- 5. 至少一次：确保消息至少会被消费一次，但有可能会出现重复消费的情况。
- 6. 回溯消费：能够按照指定时间点回溯到历史数据并重新消费。
- 7. 事务消息：支持消息发送和执行的原子性操作，确保消息的可靠性和一致性。
- 8. 定时消息：允许在指定时间点进行投递，例如实现延迟任务的功能。
- 9. 消息重试：在消息发送或处理失败后，自动尝试重新发送或处理消息，确保消息的及时性和可靠性。
- 10. 消息重投：在消息处理失败后，手动触发重新投递消息，以便再次进行处理。
- 11. 流量控制：限制消息队列中的消息流量，以避免过载或拥塞。
- 12. 死信队列：当消息无法被正常处理时，将其发送到死信队列中，以便后续处理或调查异常情况。